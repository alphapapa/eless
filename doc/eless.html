<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-05-04 Thu 02:53 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>eless &#x2013; A Better less</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Kaushal.Modi" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
<link href="https://cdn.rawgit.com/kaushalmodi/.emacs.d/master/misc/css/leuven_theme.css" rel="stylesheet">
<link href="https://cdn.rawgit.com/kaushalmodi/.emacs.d/master/misc/css/bootstrap.extra.css" rel="stylesheet">
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">eless &#x2013; A Better less</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgc68f903">1. Eless Options</a></li>
<li><a href="#org29703c2">2. <code>view-mode</code> Common Bindings</a></li>
<li><a href="#org0a0307e">3. Custom Bindings</a></li>
<li><a href="#org6a716f8">4. Usage Examples</a></li>
<li><a href="#org4ee33ee">5. Code</a>
<ul>
<li><a href="#orgd3ed485">5.1. Current <code>eless</code> Version</a></li>
<li><a href="#org798e659">5.2. Unofficial Bash Strict Mode</a></li>
<li><a href="#org1e146b9">5.3. Initialize variables</a></li>
<li><a href="#orge291a07">5.4. Input/Output</a></li>
<li><a href="#org79b6776">5.5. Parse options</a></li>
<li><a href="#org6e02870">5.6. Print Help</a></li>
<li><a href="#org8addc80">5.7. Emacs with <code>-Q</code> in <code>view-mode</code></a></li>
<li><a href="#org9a301c6">5.8. Emacs Configuration</a>
<ul>
<li><a href="#org4e7162b">5.8.1. General setup</a></li>
<li><a href="#orgd9f4495">5.8.2. Ido setup</a></li>
<li><a href="#org98e1874">5.8.3. Isearch setup</a></li>
<li><a href="#org07a67a2">5.8.4. Enable line truncation</a></li>
<li><a href="#org55ff433">5.8.5. Highlight the current line</a></li>
<li><a href="#org0c9aedc">5.8.6. Custom functions</a>
<ul>
<li><a href="#org8996c23">5.8.6.1. Keep/delete matching lines</a></li>
<li><a href="#org0c883c2">5.8.6.2. Frame and font re-sizing</a></li>
<li><a href="#orgc08a9a4">5.8.6.3. Revert buffer in <code>view-mode</code></a></li>
<li><a href="#org39f05dc">5.8.6.4. Detect if <code>diff-mode</code> should be enabled</a></li>
<li><a href="#org8ce573f">5.8.6.5. Detect if ANSI codes need to be converted to colors</a></li>
<li><a href="#orgc004e11">5.8.6.6. &ldquo;Do The Right Thing&rdquo; Kill</a></li>
<li><a href="#org14a6be1">5.8.6.7. <code>dired-mode</code> setup</a></li>
<li><a href="#orge4df6a6">5.8.6.8. <code>Man-mode</code> setup</a></li>
<li><a href="#org1cb4034">5.8.6.9. <code>Info-mode</code> setup</a></li>
</ul>
</li>
<li><a href="#org8548013">5.8.7. Auto-setting of major modes</a></li>
<li><a href="#org87948b4">5.8.8. Key bindings</a></li>
</ul>
</li>
<li><a href="#orgd7f0e71">5.9. Input/Output Scenarios</a>
<ul>
<li><a href="#orgb8c6597">5.9.1. Output is going to a pipe</a></li>
<li><a href="#orgd5c028f">5.9.2. Input is coming from a pipe</a>
<ul>
<li><a href="#org1629f50">5.9.2.1. Input is piped from <code>man</code> command</a></li>
<li><a href="#orgd23e2ee">5.9.2.2. Input is piped from <code>info</code> command</a></li>
<li><a href="#orgb085634">5.9.2.3. Input is piped from something else</a></li>
</ul>
</li>
<li><a href="#org40597b1">5.9.3. Input is an argument to the script</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org7544b28">6. Contributing Guide&#xa0;&#xa0;&#xa0;<span class="tag"><span class="contributing">contributing</span></span></a>
<ul>
<li><a href="#org1241c89">6.1. How to help debug</a></li>
<li><a href="#org6c6b427">6.2. How to generate the <code>eless</code> script</a></li>
<li><a href="#orgb15e67a">6.3. How to generate the documentation too</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgc68f903" class="outline-2">
<h2 id="orgc68f903"><span class="section-number-2">1</span> Eless Options</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">
<pre><code class="src src-org"><span class="org-org-table">|-------+--------------------------|</span>
<span class="org-org-table">| -h    | Show this help  and quit |</span>
<span class="org-org-table">| --gui | Run emacs in GUI mode    |</span>
<span class="org-org-table">| -V    | Print version and quit   |</span>
<span class="org-org-table">| -D    | Run with debug messages  |</span>
<span class="org-org-table">|-------+--------------------------|</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org29703c2" class="outline-2">
<h2 id="org29703c2"><span class="section-number-2">2</span> <code>view-mode</code> Common Bindings</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">
<pre><code class="src src-org"><span class="org-org-table">|--------------+------------------------------------------------------------------------------|</span>
<span class="org-org-table">| SPC          | Scroll forward 'page size' lines. With prefix scroll forward prefix lines.   |</span>
<span class="org-org-table">| DEL or S-SPC | Scroll backward 'page size' lines. With prefix scroll backward prefix lines. |</span>
<span class="org-org-table">|              | (If your terminal does not support this, use xterm instead or using C-h.)    |</span>
<span class="org-org-table">| RET          | Scroll forward one line. With prefix scroll forward prefix line(s).          |</span>
<span class="org-org-table">| y            | Scroll backward one line. With prefix scroll backward prefix line(s).        |</span>
<span class="org-org-table">|--------------+------------------------------------------------------------------------------|</span>
<span class="org-org-table">| s            | Do forward incremental search.                                               |</span>
<span class="org-org-table">| r            | Do reverse incremental search.                                               |</span>
<span class="org-org-table">|--------------+------------------------------------------------------------------------------|</span>
<span class="org-org-table">| e            | Quit the 'view-mode' and use that emacs session as usual to modify           |</span>
<span class="org-org-table">|              | the opened file if needed.                                                   |</span>
<span class="org-org-table">|--------------+------------------------------------------------------------------------------|</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org0a0307e" class="outline-2">
<h2 id="org0a0307e"><span class="section-number-2">3</span> Custom Bindings</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">
<pre><code class="src src-org"><span class="org-org-table">|--------------+------------------------------------------------------------|</span>
<span class="org-org-table">| ! or K       | Delete lines matching regexp                               |</span>
<span class="org-org-table">| &amp; or k       | Keep lines matching regexp                                 |</span>
<span class="org-org-table">| 0            | Delete this window                                         |</span>
<span class="org-org-table">| 1            | Keep only this window                                      |</span>
<span class="org-org-table">| A            | Auto-revert Tail Mode (like tail -f on current buffer)     |</span>
<span class="org-org-table">| N            | Next error (next line in </span><span class="org-org-table"><span class="org-bold">*occur*</span></span><span class="org-org-table">)                          |</span>
<span class="org-org-table">| P            | Previous error (previous line in </span><span class="org-org-table"><span class="org-bold">*occur*</span></span><span class="org-org-table">)                  |</span>
<span class="org-org-table">| g or F5      | Revert buffer (probably after keep/delete lines)           |</span>
<span class="org-org-table">| n            | Next line                                                  |</span>
<span class="org-org-table">| o            | Occur                                                      |</span>
<span class="org-org-table">| p            | Previous line                                              |</span>
<span class="org-org-table">| q            | Quit emacs if at most one buffer is open, else kill buffer |</span>
<span class="org-org-table">| t            | Toggle line truncation                                     |</span>
<span class="org-org-table">| </span><span class="org-org-formula">= or + or -  </span><span class="org-org-table">| Adjust font size (in GUI mode)                             |</span>
<span class="org-org-table">| C-down/up    | Inc/Dec frame height (in GUI mode)                         |</span>
<span class="org-org-table">| C-right/left | Inc/Dec frame width (in GUI mode)                          |</span>
<span class="org-org-table">|--------------+------------------------------------------------------------|</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org6a716f8" class="outline-2">
<h2 id="org6a716f8"><span class="section-number-2">4</span> Usage Examples</h2>
<div class="outline-text-2" id="text-4">
<div class="org-src-container">
<pre><code class="src src-shell">eless foo.txt               <span class="org-comment-delimiter"># </span><span class="org-comment">Open foo.txt in eless in terminal (-nw) mode by default.</span>
eless foo.txt --gui         <span class="org-comment-delimiter"># </span><span class="org-comment">Open foo.txt in eless in GUI mode.</span>
<span class="org-builtin">echo</span> <span class="org-string">'foo'</span> | eless          <span class="org-comment-delimiter">#</span>
<span class="org-builtin">echo</span> <span class="org-string">'foo'</span> | eless -        <span class="org-comment-delimiter"># </span><span class="org-comment">Same as above. The hyphen after eless does not matter; is anyways discarded.</span>
grep <span class="org-string">'bar'</span> foo.txt | eless  <span class="org-comment-delimiter">#</span>
<span class="org-variable-name">PAGER</span>=eless man grep        <span class="org-comment-delimiter"># </span><span class="org-comment">Launches man pages in eless (terminal mode), if the environment variable PAGER is set to eless.</span>
<span class="org-variable-name">PAGER</span>=eless man grep --gui  <span class="org-comment-delimiter"># </span><span class="org-comment">Launches man pages in eless (GUI mode), if the environment variable PAGER is set to eless.</span>
diff foo bar | eless        <span class="org-comment-delimiter"># </span><span class="org-comment">Colored diff!</span>
eless .                     <span class="org-comment-delimiter"># </span><span class="org-comment">Open dired in the current directory (enhanced 'ls')</span>
ls --color=always | eless   <span class="org-comment-delimiter"># </span><span class="org-comment">Auto-detect ANSI color codes and convert those to colors</span>
eless -h | eless            <span class="org-comment-delimiter"># </span><span class="org-comment">See eless help ;-)</span>
info emacs | eless          <span class="org-comment-delimiter"># </span><span class="org-comment">Read emacs Info manual in eless</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org4ee33ee" class="outline-2">
<h2 id="org4ee33ee"><span class="section-number-2">5</span> Code</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgd3ed485" class="outline-3">
<h3 id="orgd3ed485"><span class="section-number-3">5.1</span> Current <code>eless</code> Version</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">
<pre><code class="src src-text">master
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org798e659" class="outline-3">
<h3 id="org798e659"><span class="section-number-3">5.2</span> Unofficial Bash Strict Mode</h3>
<div class="outline-text-3" id="text-5-2">
<p>
The <a href="http://redsymbol.net/articles/unofficial-bash-strict-mode/"><i>Unofficial Bash Strict Mode</i></a> is enabled to make this script more
robust and reliable.
</p>

<p>
The script will error out immediately when,
</p>
<ol class="org-ol">
<li><p>
Any command in a pipeline in this code fails.
</p>
<div class="org-src-container">
<pre><code class="src src-shell"><span class="org-builtin">set</span> -o pipefail
</code></pre>
</div></li>
<li><p>
Any line in this script returns an error
</p>
<div class="org-src-container">
<pre><code class="src src-shell"><span class="org-builtin">set</span> -e <span class="org-comment-delimiter"># </span><span class="org-comment">Error out and exit the script when any line in this script returns an error</span>
</code></pre>
</div></li>
<li><p>
Any undefined variable is referenced.
</p>
<div class="org-src-container">
<pre><code class="src src-shell"><span class="org-builtin">set</span> -u <span class="org-comment-delimiter"># </span><span class="org-comment">Error out when unbound variables are found</span>
</code></pre>
</div></li>
</ol>
</div>
</div>

<div id="outline-container-org1e146b9" class="outline-3">
<h3 id="org1e146b9"><span class="section-number-3">5.3</span> Initialize variables</h3>
<div class="outline-text-3" id="text-5-3">
<div class="org-src-container">
<pre><code class="src src-shell"><span class="org-variable-name">help</span>=0
<span class="org-variable-name">debug</span>=0
<span class="org-variable-name">no_window_arg</span>=<span class="org-string">"-nw"</span>
<span class="org-variable-name">emacs_args</span>=<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"${no_window_arg}"</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter"># </span><span class="org-comment">Run emacs with -nw by default</span>
<span class="org-variable-name">piped_data</span>=<span class="org-string">''</span>
<span class="org-variable-name">tempfile</span>=<span class="org-string">''</span>
<span class="org-variable-name">cmd</span>=<span class="org-string">''</span>

<span class="org-variable-name">input_from_pipe_flag</span>=0
<span class="org-variable-name">output_to_pipe_flag</span>=0
</code></pre>
</div>

<p>
If user has passed the <code>-D</code> option, run the script in debug mode.
</p>

<div class="org-src-container">
<pre><code class="src src-shell">for var<span class="org-keyword"> in</span> <span class="org-string">"$@"</span>
do
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> <span class="org-string">"${var}"</span> == <span class="org-string">'-D'</span> <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        eless_print_version
        <span class="org-variable-name">debug</span>=1
    fi
done
</code></pre>
</div>
</div>
</div>
<div id="outline-container-orge291a07" class="outline-3">
<h3 id="orge291a07"><span class="section-number-3">5.4</span> Input/Output</h3>
<div class="outline-text-3" id="text-5-4">
<p>
We need this script to know:
</p>
<ul class="org-ul">
<li>Where it is getting the input from:
<ul class="org-ul">
<li><p>
From the terminal?
</p>
<div class="org-src-container">
<pre><code class="src src-shell">    eless foo
</code></pre>
</div></li>
<li><p>
From a pipe?
</p>
<div class="org-src-container">
<pre><code class="src src-shell">    diff a b | eless
</code></pre>
</div></li>
</ul></li>
<li>Where the output is going to:
<ul class="org-ul">
<li><p>
To the terminal?
</p>
<div class="org-src-container">
<pre><code class="src src-shell">    eless foo
</code></pre>
</div></li>
<li><p>
To a pipe?
</p>
<div class="org-src-container">
<pre><code class="src src-shell">    eless | grep foo
</code></pre>
</div>
<p>
In this case, we do not do anything at the moment. See <a href="https://github.com/kaushalmodi/eless/issues/4">here</a>.
</p></li>
</ul></li>
</ul>

<p>
Below code determines that using <code>[[ -t 0 ]]</code> and <code>[[ -t 1]]</code>.
</p>
<div class="org-src-container">
<pre><code class="src src-shell"><span class="org-comment-delimiter"># </span><span class="org-comment">https://gist.github.com/davejamesmiller/1966557</span>
<span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> -t 0 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-comment-delimiter"># </span><span class="org-comment">Script is called normally - Terminal input (keyboard) - interactive</span>
<span class="org-keyword">then</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">eless foo</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">eless foo | cat -</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">debug</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        <span class="org-builtin">echo</span> <span class="org-string">"--&gt; Input from terminal"</span>
    fi
    <span class="org-variable-name">input_from_pipe_flag</span>=0
<span class="org-keyword">else</span> <span class="org-comment-delimiter"># </span><span class="org-comment">Script is getting input from pipe or file - non-interactive</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">echo bar | eless foo</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">echo bar | eless foo | cat -</span>
    <span class="org-variable-name">piped_data</span>=<span class="org-string">"$(cat)"</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">debug</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        <span class="org-builtin">echo</span> <span class="org-string">"--&gt; Input from pipe/file"</span>
    fi
    <span class="org-variable-name">input_from_pipe_flag</span>=1
fi

<span class="org-comment-delimiter"># </span><span class="org-comment">http://stackoverflow.com/a/911213/1219634</span>
<span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> -t 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span> <span class="org-comment-delimiter"># </span><span class="org-comment">Output is going to the terminal</span>
<span class="org-keyword">then</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">eless foo</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">echo bar | eless foo</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">debug</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        <span class="org-builtin">echo</span> <span class="org-string">"    Output to terminal --&gt;"</span>
    fi
    <span class="org-variable-name">output_to_pipe_flag</span>=0
<span class="org-keyword">else</span> <span class="org-comment-delimiter"># </span><span class="org-comment">Output is going to a pipe, file?</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">eless foo | cat -</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">echo bar | eless foo | cat -</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">debug</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        <span class="org-builtin">echo</span> <span class="org-string">"    Output to a pipe --&gt;"</span>
    fi
    <span class="org-variable-name">output_to_pipe_flag</span>=1
fi
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org79b6776" class="outline-3">
<h3 id="org79b6776"><span class="section-number-3">5.5</span> Parse options</h3>
<div class="outline-text-3" id="text-5-5">
<p>
We need to parse the arguments such that arguments specific to this
script like <code>-D</code> and <code>--gui</code> get consumed here, and the ones not known
to this script get passed to <code>emacs</code>.
</p>

<p>
<code>getopt</code> does not support ignoring undefined options. So the below
basic approach of looping through all the arguments <code>"$@"</code> is used.
</p>
<div class="org-src-container">
<pre><code class="src src-shell">for var<span class="org-keyword"> in</span> <span class="org-string">"$@"</span>
do
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">debug</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        <span class="org-builtin">echo</span> <span class="org-string">"var : $var"</span>
    fi
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> <span class="org-string">"${var}"</span> == <span class="org-string">'-D'</span> <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        : <span class="org-comment-delimiter"># </span><span class="org-comment">Put just a colon to represent null operation # https://unix.stackexchange.com/a/133976/57923</span>
          <span class="org-comment-delimiter"># </span><span class="org-comment">Do not pass -D option to emacs.</span>
    elif <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> <span class="org-string">"${var}"</span> == <span class="org-string">'-V'</span> <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        eless_print_version
        <span class="org-keyword">exit</span> 0
    elif <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> <span class="org-string">"${var}"</span> == <span class="org-string">'-'</span> <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        : <span class="org-comment-delimiter"># </span><span class="org-comment">Discard the '-'; it does nothing. (for the cases where a user might do "echo foo | eless -")</span>
    elif <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> <span class="org-string">"${var}"</span> == <span class="org-string">'-nw'</span> <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        : <span class="org-comment-delimiter"># </span><span class="org-comment">Ignore the user-passed "-nw" option; we are adding it by default.</span>
    elif <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> <span class="org-string">"${var}"</span> == <span class="org-string">'-h'</span> <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">Do not hijack --help; use that to show emacs help</span>
    <span class="org-keyword">then</span>
        <span class="org-variable-name">help</span>=1
    elif <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> <span class="org-string">"${var}"</span> == <span class="org-string">'--gui'</span> <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">Delete the ${no_window_arg} from ${emacs_args[@]} array if user passed "--gui" option</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">http://stackoverflow.com/a/16861932/1219634</span>
        <span class="org-variable-name">emacs_args</span>=<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"${emacs_args[@]/${no_window_arg}}"</span><span class="org-rainbow-delimiters-depth-1">)</span>
    <span class="org-keyword">else</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">Collect all other arguments passed to eless and forward them to emacs.</span>
        <span class="org-variable-name">emacs_args</span>=<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-string">"${emacs_args[@]}"</span> <span class="org-string">"${var}"</span><span class="org-rainbow-delimiters-depth-1">)</span>
    fi
done
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org6e02870" class="outline-3">
<h3 id="org6e02870"><span class="section-number-3">5.6</span> Print Help</h3>
<div class="outline-text-3" id="text-5-6">
<p>
If user asked for this script&rsquo;s help, just print it and exit with
success code.
</p>
<div class="org-src-container">
<pre><code class="src src-shell"><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">help</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-keyword">then</span>
    eless_print_version
    <span class="org-builtin">echo</span> <span class="org-string">"${h}"</span>
    <span class="org-keyword">exit</span> 0
fi
</code></pre>
</div>
</div>
</div>

<div id="outline-container-org8addc80" class="outline-3">
<h3 id="org8addc80"><span class="section-number-3">5.7</span> Emacs with <code>-Q</code> in <code>view-mode</code></h3>
<div class="outline-text-3" id="text-5-7">
<p>
The <code>emacs_Q_view_mode</code> function is defined to launch emacs with a
customized <code>view-mode</code>.
</p>

<p>
<i>Refer to further sections below to see the elisp code referenced by
the <code>&lt;&lt;emacs-config&gt;&gt;</code> <b>noweb</b> placeholder in the below snippet.</i>
</p>

<div class="org-src-container">
<pre><code class="src src-shell">function emacs_Q_view_mode <span class="org-rainbow-delimiters-depth-1">{</span>

    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">[</span><span class="org-rainbow-delimiters-depth-3">[</span> $<span class="org-rainbow-delimiters-depth-4">{</span><span class="org-variable-name">debug</span><span class="org-rainbow-delimiters-depth-4">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-3">]</span><span class="org-rainbow-delimiters-depth-2">]</span>
    <span class="org-keyword">then</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">Here $@ is the list of arguments passed specifically to emacs_Q_view_mode,</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">not to eless.</span>
        <span class="org-builtin">echo</span> <span class="org-string">"Args passed to emacs_Q_view_mode : $*"</span>
    fi
    <span class="org-keyword">exec</span> emacs -Q <span class="org-string">"$@"</span> <span class="org-sh-escaped-newline">\</span>
               -f view-mode <span class="org-sh-escaped-newline">\</span>
               --eval <span class="org-string">'(progn</span>
<span class="org-string">                          &lt;&lt;emacs-config&gt;&gt;</span>
<span class="org-string">                       )'</span> 2&gt;/dev/null &lt;/dev/tty
<span class="org-rainbow-delimiters-depth-1">}</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org9a301c6" class="outline-3">
<h3 id="org9a301c6"><span class="section-number-3">5.8</span> Emacs Configuration</h3>
<div class="outline-text-3" id="text-5-8">
</div>
<div id="outline-container-org4e7162b" class="outline-4">
<h4 id="org4e7162b"><span class="section-number-4">5.8.1</span> General setup</h4>
<div class="outline-text-4" id="text-5-8-1">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Keep the default-directory to be the same from where</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">this script was launched from; useful during C-x C-f</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> default-directory <span class="org-string">"'"</span>$<span class="org-rainbow-delimiters-depth-2">(</span>pwd<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-string">"'/"</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">No clutter</span>
<span class="org-rainbow-delimiters-depth-1">(</span>menu-bar-mode -1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-2">(</span>fboundp <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> tool-bar-mode<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span>tool-bar-mode -1<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Pleasant dark theme</span>
<span class="org-rainbow-delimiters-depth-1">(</span>load-theme <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> tango-dark<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-builtin">:no-confirm</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">Show line and column numbers in the mode-line</span>
<span class="org-rainbow-delimiters-depth-1">(</span>line-number-mode 1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>column-number-mode 1<span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq-default</span> indent-tabs-mode nil<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Use spaces instead of tabs for indentation</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> x-select-enable-clipboard t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> x-select-enable-primary t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> save-interprogram-paste-before-kill t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> require-final-newline t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> visible-bell t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> load-prefer-newer t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ediff-window-setup-function <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> ediff-setup-windows-plain<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span>fset <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> yes-or-no-p<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> y-or-n-p<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Use y or n instead of yes or no</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-orgd9f4495" class="outline-4">
<h4 id="orgd9f4495"><span class="section-number-4">5.8.2</span> Ido setup</h4>
<div class="outline-text-4" id="text-5-8-2">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>ido-mode 1<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ido-enable-flex-matching t<span class="org-rainbow-delimiters-depth-1">)</span>       <span class="org-comment-delimiter">;</span><span class="org-comment">Enable fuzzy search</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ido-everywhere t<span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ido-create-new-buffer <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> always<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Create a new buffer if no buffer matches substringv</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> ido-use-filename-at-point <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> guess<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Find file at point using ido</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-to-list <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> ido-ignore-buffers<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-string">"*Messages*"</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org98e1874" class="outline-4">
<h4 id="org98e1874"><span class="section-number-4">5.8.3</span> Isearch setup</h4>
<div class="outline-text-4" id="text-5-8-3">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> isearch-allow-scroll t<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Allow scrolling using isearch</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">DEL during isearch should edit the search string, not jump back to the previous result.</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key isearch-mode-map <span class="org-rainbow-delimiters-depth-2">[</span>remap isearch-delete-char<span class="org-rainbow-delimiters-depth-2">]</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> isearch-del-char<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org07a67a2" class="outline-4">
<h4 id="org07a67a2"><span class="section-number-4">5.8.4</span> Enable line truncation</h4>
<div class="outline-text-4" id="text-5-8-4">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-comment-delimiter">;; </span><span class="org-comment">Truncate long lines by default</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">setq</span> truncate-partial-width-windows nil<span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Respect the value of truncate-lines</span>
<span class="org-rainbow-delimiters-depth-1">(</span>toggle-truncate-lines +1<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org55ff433" class="outline-4">
<h4 id="org55ff433"><span class="section-number-4">5.8.5</span> Highlight the current line</h4>
<div class="outline-text-4" id="text-5-8-5">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>hl-line-mode 1<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org0c9aedc" class="outline-4">
<h4 id="org0c9aedc"><span class="section-number-4">5.8.6</span> Custom functions</h4>
<div class="outline-text-4" id="text-5-8-6">
</div>
<div id="outline-container-org8996c23" class="outline-5">
<h5 id="org8996c23"><span class="section-number-5">5.8.6.1</span> Keep/delete matching lines</h5>
<div class="outline-text-5" id="text-5-8-6-1">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/keep-lines</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>inhibit-read-only t<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Ignore read-only status of buffer</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-excursion</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>goto-char <span class="org-rainbow-delimiters-depth-5">(</span>point-min<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>call-interactively <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">quote</span> keep-lines<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/delete-matching-lines</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>inhibit-read-only t<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Ignore read-only status of buffer</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">save-excursion</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>goto-char <span class="org-rainbow-delimiters-depth-5">(</span>point-min<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>call-interactively <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">quote</span> delete-matching-lines<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org0c883c2" class="outline-5">
<h5 id="org0c883c2"><span class="section-number-5">5.8.6.2</span> Frame and font re-sizing</h5>
<div class="outline-text-5" id="text-5-8-6-2">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/frame-width-half</span> <span class="org-rainbow-delimiters-depth-2">(</span>double<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span> <span class="org-string">"P"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>frame-resize-pixelwise t<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Do not round frame sizes to character h/w</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>factor <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">if</span> double 2 0.5<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>set-frame-size nil <span class="org-rainbow-delimiters-depth-4">(</span>round <span class="org-rainbow-delimiters-depth-5">(</span>* factor <span class="org-rainbow-delimiters-depth-6">(</span>frame-text-width<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>frame-text-height<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-builtin">:pixelwise</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/frame-width-double</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>eless/frame-width-half <span class="org-builtin">:double</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/frame-height-half</span> <span class="org-rainbow-delimiters-depth-2">(</span>double<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span> <span class="org-string">"P"</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>frame-resize-pixelwise t<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Do not round frame sizes to character h/w</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>factor <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">if</span> double 2 0.5<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>set-frame-size nil  <span class="org-rainbow-delimiters-depth-4">(</span>frame-text-width<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-rainbow-delimiters-depth-4">(</span>round <span class="org-rainbow-delimiters-depth-5">(</span>* factor <span class="org-rainbow-delimiters-depth-6">(</span>frame-text-height<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-builtin">:pixelwise</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/frame-height-double</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>eless/frame-height-half <span class="org-builtin">:double</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-orgc08a9a4" class="outline-5">
<h5 id="orgc08a9a4"><span class="section-number-5">5.8.6.3</span> Revert buffer in <code>view-mode</code></h5>
<div class="outline-text-5" id="text-5-8-6-3">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/revert-buffer-retain-view-mode</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>view-mode-state view-mode<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">save the current state of view-mode</span>
    <span class="org-rainbow-delimiters-depth-3">(</span>revert-buffer<span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">when</span> view-mode-state
      <span class="org-rainbow-delimiters-depth-4">(</span>view-mode 1<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org39f05dc" class="outline-5">
<h5 id="org39f05dc"><span class="section-number-5">5.8.6.4</span> Detect if <code>diff-mode</code> should be enabled</h5>
<div class="outline-text-5" id="text-5-8-6-4">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/enable-diff-mode-maybe</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-excursion</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>max-line 10<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Search first MAX-LINE lines of the buffer</span>
           <span class="org-rainbow-delimiters-depth-5">(</span>bound <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">progn</span>
                    <span class="org-rainbow-delimiters-depth-7">(</span>goto-char <span class="org-rainbow-delimiters-depth-8">(</span>point-min<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
                    <span class="org-rainbow-delimiters-depth-7">(</span>forward-line max-line<span class="org-rainbow-delimiters-depth-7">)</span>
                    <span class="org-rainbow-delimiters-depth-7">(</span>point<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>goto-char <span class="org-rainbow-delimiters-depth-5">(</span>point-min<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-5">(</span>re-search-forward <span class="org-string">"^</span><span class="org-string"><span class="org-easy-escape"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-backslash">\\</span></span></span></span><span class="org-string"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-construct">(</span></span></span><span class="org-string"><span class="org-regexp-grouping-construct">?:</span></span><span class="org-string">[0-9]+,</span><span class="org-string"><span class="org-easy-escape"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-backslash">\\</span></span></span></span><span class="org-string"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-construct">)</span></span></span><span class="org-string">?[0-9]+</span><span class="org-string"><span class="org-easy-escape"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-backslash">\\</span></span></span></span><span class="org-string"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-construct">(</span></span></span><span class="org-string"><span class="org-regexp-grouping-construct">?1:</span></span><span class="org-string">[adc]</span><span class="org-string"><span class="org-easy-escape"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-backslash">\\</span></span></span></span><span class="org-string"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-construct">)</span></span></span><span class="org-string"><span class="org-easy-escape"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-backslash">\\</span></span></span></span><span class="org-string"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-construct">(</span></span></span><span class="org-string"><span class="org-regexp-grouping-construct">?:</span></span><span class="org-string">[0-9]+,</span><span class="org-string"><span class="org-easy-escape"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-backslash">\\</span></span></span></span><span class="org-string"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-construct">)</span></span></span><span class="org-string">?[0-9]+$"</span> bound <span class="org-builtin">:noerror</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>forward-line 1<span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>diff-type <span class="org-rainbow-delimiters-depth-8">(</span>match-string-no-properties 1<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
              <span class="org-rainbow-delimiters-depth-7">(</span>diff-mode-enable nil<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">cond</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">Line(s) added</span>
           <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-rainbow-delimiters-depth-8">(</span>string= diff-type <span class="org-string">"a"</span><span class="org-rainbow-delimiters-depth-8">)</span>
            <span class="org-rainbow-delimiters-depth-8">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-9">(</span>re-search-forward <span class="org-string">"^&gt; "</span> nil <span class="org-builtin">:noerror</span><span class="org-rainbow-delimiters-depth-9">)</span>
              <span class="org-rainbow-delimiters-depth-9">(</span><span class="org-keyword">setq</span> diff-mode-enable t<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">Line(s) deleted or changed</span>
           <span class="org-rainbow-delimiters-depth-7">(</span>t
            <span class="org-rainbow-delimiters-depth-8">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-9">(</span>re-search-forward <span class="org-string">"^&lt; "</span> nil <span class="org-builtin">:noerror</span><span class="org-rainbow-delimiters-depth-9">)</span>
              <span class="org-rainbow-delimiters-depth-9">(</span><span class="org-keyword">setq</span> diff-mode-enable t<span class="org-rainbow-delimiters-depth-9">)</span><span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">when</span> diff-mode-enable
            <span class="org-rainbow-delimiters-depth-7">(</span>message <span class="org-string">"Auto-enabling diff-mode"</span><span class="org-rainbow-delimiters-depth-7">)</span>
            <span class="org-rainbow-delimiters-depth-7">(</span>diff-mode<span class="org-rainbow-delimiters-depth-7">)</span>
            <span class="org-rainbow-delimiters-depth-7">(</span>rename-buffer <span class="org-string">"*Diff*"</span> <span class="org-builtin">:unique</span><span class="org-rainbow-delimiters-depth-7">)</span>
            <span class="org-rainbow-delimiters-depth-7">(</span>view-mode 1<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Re-enable view-mode</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org8ce573f" class="outline-5">
<h5 id="org8ce573f"><span class="section-number-5">5.8.6.5</span> Detect if ANSI codes need to be converted to colors</h5>
<div class="outline-text-5" id="text-5-8-6-5">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/enable-ansi-color-maybe</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">save-excursion</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">let*</span> <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-rainbow-delimiters-depth-5">(</span>max-line 100<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Search first MAX-LINE lines of the buffer</span>
           <span class="org-rainbow-delimiters-depth-5">(</span>bound <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">progn</span>
                    <span class="org-rainbow-delimiters-depth-7">(</span>goto-char <span class="org-rainbow-delimiters-depth-8">(</span>point-min<span class="org-rainbow-delimiters-depth-8">)</span><span class="org-rainbow-delimiters-depth-7">)</span>
                    <span class="org-rainbow-delimiters-depth-7">(</span>forward-line max-line<span class="org-rainbow-delimiters-depth-7">)</span>
                    <span class="org-rainbow-delimiters-depth-7">(</span>point<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span>
           <span class="org-rainbow-delimiters-depth-5">(</span>ESC <span class="org-string">"\u001b"</span><span class="org-rainbow-delimiters-depth-5">)</span>
           <span class="org-comment-delimiter">;; </span><span class="org-comment">Example ANSI codes: ^[[0;36m, or ^[[0m where ^[ is the ESC char</span>
           <span class="org-rainbow-delimiters-depth-5">(</span>ansi-regexp <span class="org-rainbow-delimiters-depth-6">(</span>concat ESC <span class="org-string">"</span><span class="org-string"><span class="org-easy-escape">\\</span></span><span class="org-string">["</span> <span class="org-string">"[0-9]+</span><span class="org-string"><span class="org-easy-escape"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-backslash">\\</span></span></span></span><span class="org-string"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-construct">(</span></span></span><span class="org-string">;[0-9]+</span><span class="org-string"><span class="org-easy-escape"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-backslash">\\</span></span></span></span><span class="org-string"><span class="org-easy-escape-delimiter"><span class="org-regexp-grouping-construct">)</span></span></span><span class="org-string">*m"</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>goto-char <span class="org-rainbow-delimiters-depth-5">(</span>point-min<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-5">(</span>re-search-forward ansi-regexp bound <span class="org-builtin">:noerror</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-rainbow-delimiters-depth-7">(</span>inhibit-read-only t<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Ignore read-only status of buffer</span>
          <span class="org-rainbow-delimiters-depth-6">(</span>message <span class="org-string">"Auto-converting ANSI codes to colors"</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span><span class="org-keyword">require</span> <span class="org-rainbow-delimiters-depth-7">(</span><span class="org-keyword">quote</span> ansi-color<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
          <span class="org-rainbow-delimiters-depth-6">(</span>ansi-color-apply-on-region <span class="org-rainbow-delimiters-depth-7">(</span>point-min<span class="org-rainbow-delimiters-depth-7">)</span> <span class="org-rainbow-delimiters-depth-7">(</span>point-max<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-orgc004e11" class="outline-5">
<h5 id="orgc004e11"><span class="section-number-5">5.8.6.6</span> &ldquo;Do The Right Thing&rdquo; Kill</h5>
<div class="outline-text-5" id="text-5-8-6-6">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/save-buffers-maybe-and-kill-emacs</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">dolist</span> <span class="org-rainbow-delimiters-depth-3">(</span>buf <span class="org-rainbow-delimiters-depth-4">(</span>buffer-list<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">with-current-buffer</span> buf
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">and</span> <span class="org-rainbow-delimiters-depth-6">(</span>buffer-file-name<span class="org-rainbow-delimiters-depth-6">)</span>
                 <span class="org-rainbow-delimiters-depth-6">(</span>file-exists-p <span class="org-rainbow-delimiters-depth-7">(</span>buffer-file-name<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                 view-mode<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Force-revert all view-mode file buffers to prevent save prompt on quitting</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>revert-buffer <span class="org-builtin">:ignore-auto</span> <span class="org-builtin">:noconfirm</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>view-mode 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>save-buffers-kill-emacs<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/kill-emacs-or-buffer</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">interactive</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">let</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-rainbow-delimiters-depth-4">(</span>num-non-special-buffers 0<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">dolist</span> <span class="org-rainbow-delimiters-depth-4">(</span>buf <span class="org-rainbow-delimiters-depth-5">(</span>buffer-list<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">unless</span> <span class="org-rainbow-delimiters-depth-5">(</span>string-match-p <span class="org-string">"</span><span class="org-string"><span class="org-easy-escape">\\</span></span><span class="org-string">`</span><span class="org-string"><span class="org-easy-escape">\\</span></span><span class="org-string">s-*</span><span class="org-string"><span class="org-easy-escape">\\</span></span><span class="org-string">*"</span> <span class="org-rainbow-delimiters-depth-6">(</span>buffer-name buf<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Do not count buffers with names starting with space or *</span>
        <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">setq</span> num-non-special-buffers <span class="org-rainbow-delimiters-depth-6">(</span>+ 1 num-non-special-buffers<span class="org-rainbow-delimiters-depth-6">)</span><span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span>
    <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-4">(</span>&lt;= num-non-special-buffers 1<span class="org-rainbow-delimiters-depth-4">)</span>
        <span class="org-rainbow-delimiters-depth-4">(</span>eless/save-buffers-maybe-and-kill-emacs<span class="org-rainbow-delimiters-depth-4">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Kill emacs if one or less non-special buffers are open</span>
      <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-5">(</span><span class="org-keyword">and</span> <span class="org-rainbow-delimiters-depth-6">(</span>buffer-file-name<span class="org-rainbow-delimiters-depth-6">)</span>
                 <span class="org-rainbow-delimiters-depth-6">(</span>file-exists-p <span class="org-rainbow-delimiters-depth-7">(</span>buffer-file-name<span class="org-rainbow-delimiters-depth-7">)</span><span class="org-rainbow-delimiters-depth-6">)</span>
                 view-mode<span class="org-rainbow-delimiters-depth-5">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">If in view-mode, force-revert current file buffer before attempting kill</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>revert-buffer <span class="org-builtin">:ignore-auto</span> <span class="org-builtin">:noconfirm</span><span class="org-rainbow-delimiters-depth-5">)</span>
        <span class="org-rainbow-delimiters-depth-5">(</span>view-mode 1<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span>
      <span class="org-rainbow-delimiters-depth-4">(</span>kill-buffer <span class="org-rainbow-delimiters-depth-5">(</span>current-buffer<span class="org-rainbow-delimiters-depth-5">)</span><span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Else only kill the current buffer</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org14a6be1" class="outline-5">
<h5 id="org14a6be1"><span class="section-number-5">5.8.6.7</span> <code>dired-mode</code> setup</h5>
<div class="outline-text-5" id="text-5-8-6-7">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/dired-mode-customization</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>view-mode -1<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Prevent view-mode bindings from shadowing dired-mode bindings</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">dired-find-file is bound to "f" and "RET" by default</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">So changing the "RET" binding to dired-view-file so that the file opens</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">in view-mode in the spirit of eless.</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>define-key dired-mode-map <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"RET"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> dired-view-file<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>define-key dired-mode-map <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"E"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> wdired-change-to-wdired-mode<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>define-key dired-mode-map <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"Q"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> quit-window<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>define-key dired-mode-map <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"q"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> eless/kill-emacs-or-buffer<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> dired-mode-hook<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> eless/dired-mode-customization<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-orge4df6a6" class="outline-5">
<h5 id="orge4df6a6"><span class="section-number-5">5.8.6.8</span> <code>Man-mode</code> setup</h5>
<div class="outline-text-5" id="text-5-8-6-8">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/Man-mode-customization</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>view-mode -1<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Prevent view-mode bindings from shadowing Man-mode bindings</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>define-key Man-mode-map <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"Q"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> quit-window<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>define-key Man-mode-map <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"q"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> eless/kill-emacs-or-buffer<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> Man-mode-hook<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> eless/Man-mode-customization<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org1cb4034" class="outline-5">
<h5 id="org1cb4034"><span class="section-number-5">5.8.6.9</span> <code>Info-mode</code> setup</h5>
<div class="outline-text-5" id="text-5-8-6-9">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">defun</span> <span class="org-function-name">eless/Info-mode-customization</span> <span class="org-rainbow-delimiters-depth-2">()</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>view-mode -1<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Prevent view-mode bindings from shadowing Info-mode bindings</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>define-key Info-mode-map <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"Q"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> quit-window<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>define-key Info-mode-map <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"q"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> eless/kill-emacs-or-buffer<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>add-hook <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> Info-mode-hook<span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> eless/Info-mode-customization<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org8548013" class="outline-4">
<h4 id="org8548013"><span class="section-number-4">5.8.7</span> Auto-setting of major modes</h4>
<div class="outline-text-4" id="text-5-8-7">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">cond</span>
 <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>derived-mode-p <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">quote</span> dired-mode<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>eless/dired-mode-customization<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
 <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>derived-mode-p <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">quote</span> Man-mode<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>eless/Man-mode-customization<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
 <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-rainbow-delimiters-depth-3">(</span>derived-mode-p <span class="org-rainbow-delimiters-depth-4">(</span><span class="org-keyword">quote</span> Info-mode<span class="org-rainbow-delimiters-depth-4">)</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span>eless/Info-mode-customization<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
 <span class="org-rainbow-delimiters-depth-2">(</span>t
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-enable diff-mode. For example, when doing "diff foo bar | eless"</span>
  <span class="org-rainbow-delimiters-depth-3">(</span>eless/enable-diff-mode-maybe<span class="org-rainbow-delimiters-depth-3">)</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Auto-convert ANSI codes to colors. For example, when doing "ls --color=always | eless"</span>
  <span class="org-rainbow-delimiters-depth-3">(</span>eless/enable-ansi-color-maybe<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-org87948b4" class="outline-4">
<h4 id="org87948b4"><span class="section-number-4">5.8.8</span> Key bindings</h4>
<div class="outline-text-4" id="text-5-8-8">
<div class="org-src-container">
<pre><code class="src src-emacs-lisp"><span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"!"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> eless/delete-matching-lines<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&amp;"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> eless/keep-lines<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"0"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> delete-window<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"1"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> delete-other-windows<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"A"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> auto-revert-tail-mode<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"N"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> next-error<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Next line in *occur*</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"P"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> previous-error<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span> <span class="org-comment-delimiter">;</span><span class="org-comment">Previous line in *occur*</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"K"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> eless/delete-matching-lines<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"g"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> eless/revert-buffer-retain-view-mode<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"k"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> eless/keep-lines<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"n"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> next-line<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"o"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> occur<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"p"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> previous-line<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"q"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> eless/kill-emacs-or-buffer<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"t"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> toggle-truncate-lines<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-comment-delimiter">;; </span><span class="org-comment">global custom bindings</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"M-/"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> hippie-expand<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x C-b"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> ibuffer<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x C-c"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> eless/save-buffers-maybe-and-kill-emacs<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-x C-f"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> view-file<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"C-c q"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> query-replace-regexp<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
<span class="org-rainbow-delimiters-depth-1">(</span>global-set-key <span class="org-rainbow-delimiters-depth-2">(</span>kbd <span class="org-string">"&lt;f5&gt;"</span><span class="org-rainbow-delimiters-depth-2">)</span> <span class="org-rainbow-delimiters-depth-2">(</span><span class="org-keyword">quote</span> eless/revert-buffer-retain-view-mode<span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>

<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-keyword">when</span> <span class="org-rainbow-delimiters-depth-2">(</span>display-graphic-p<span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"+"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> text-scale-adjust<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"-"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> text-scale-adjust<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>define-key view-mode-map <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"="</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> text-scale-adjust<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>global-set-key <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"C-&lt;right&gt;"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> eless/frame-width-double<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>global-set-key <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"C-&lt;left&gt;"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> eless/frame-width-half<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>global-set-key <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"C-&lt;down&gt;"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> eless/frame-height-double<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span>
  <span class="org-rainbow-delimiters-depth-2">(</span>global-set-key <span class="org-rainbow-delimiters-depth-3">(</span>kbd <span class="org-string">"C-&lt;up&gt;"</span><span class="org-rainbow-delimiters-depth-3">)</span> <span class="org-rainbow-delimiters-depth-3">(</span><span class="org-keyword">quote</span> eless/frame-height-half<span class="org-rainbow-delimiters-depth-3">)</span><span class="org-rainbow-delimiters-depth-2">)</span><span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd7f0e71" class="outline-3">
<h3 id="orgd7f0e71"><span class="section-number-3">5.9</span> Input/Output Scenarios</h3>
<div class="outline-text-3" id="text-5-9">
</div>
<div id="outline-container-orgb8c6597" class="outline-4">
<h4 id="orgb8c6597"><span class="section-number-4">5.9.1</span> Output is going to a pipe</h4>
<div class="outline-text-4" id="text-5-9-1">
<p>
This scenario is not supported at the moment. There
<a href="https://github.com/kaushalmodi/eless/issues/4">is a plan to support it in future</a> though.
</p>

<p>
For now, the <code>eless</code> script will exit with an error code if the output
is being piped to something else.
</p>
<div class="org-src-container">
<pre><code class="src src-shell"><span class="org-comment-delimiter"># </span><span class="org-comment">Below if condition is reached if you try to do this:</span>
<span class="org-comment-delimiter">#   </span><span class="org-comment">eless foo.txt | grep bar .. Not allowed!</span>
<span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">output_to_pipe_flag</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
<span class="org-keyword">then</span>
    <span class="org-builtin">echo</span> <span class="org-string">"This script is not supposed to send output to a pipe"</span>
    <span class="org-keyword">exit</span> 1
<span class="org-keyword">else</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-orgd5c028f" class="outline-4">
<h4 id="orgd5c028f"><span class="section-number-4">5.9.2</span> Input is coming from a pipe</h4>
<div class="outline-text-4" id="text-5-9-2">
<div class="org-src-container">
<pre><code class="src src-shell">    <span class="org-comment-delimiter"># </span><span class="org-comment">Below if condition is reached when you do this:</span>
    <span class="org-comment-delimiter">#   </span><span class="org-comment">grep 'foo' bar.txt | eless, or</span>
    <span class="org-comment-delimiter">#   </span><span class="org-comment">grep 'foo' bar.txt | eless -</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">i.e. Input to eless is coming through a pipe (from grep, in above example)</span>
    <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">input_from_pipe_flag</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
    <span class="org-keyword">then</span>
        <span class="org-variable-name">tempfile</span>=<span class="org-string">"$(mktemp emacs-stdin-"$USER".XXXXXXX --tmpdir)"</span> <span class="org-comment-delimiter"># </span><span class="org-comment">https://github.com/koalaman/shellcheck/wiki/SC2086</span>
        <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">debug</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
        <span class="org-keyword">then</span>
            <span class="org-builtin">echo</span> <span class="org-string">"Temp File : $tempfile"</span>
        fi
        <span class="org-builtin">echo</span> <span class="org-string">"${piped_data}"</span> &gt; <span class="org-string">"${tempfile}"</span> <span class="org-comment-delimiter"># </span><span class="org-comment">https://github.com/koalaman/shellcheck/wiki/SC2086</span>

        <span class="org-comment-delimiter"># </span><span class="org-comment">Parse the first line of the piped data to check if it's a man page</span>
        <span class="org-variable-name">first_line_piped_data</span>=$<span class="org-rainbow-delimiters-depth-1">(</span>head -n 1 <span class="org-string">"${tempfile}"</span><span class="org-rainbow-delimiters-depth-1">)</span>
        <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">debug</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
        <span class="org-keyword">then</span>
            <span class="org-builtin">echo</span> <span class="org-string">"first_line_piped_data = ${first_line_piped_data}"</span>
        fi

        <span class="org-comment-delimiter"># </span><span class="org-comment">The first line of man pages is assumed to be</span>
        <span class="org-comment-delimiter">#   </span><span class="org-comment">FOO(1)  optional something something FOO(1)</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">It is not mandatory for the below grep to always pass, so OR it with</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">"true" so that "set -e" does not kill the script at this point.</span>
        <span class="org-variable-name">man_page</span>=$<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-builtin">echo</span> <span class="org-string">"${first_line_piped_data}"</span> | grep -Po <span class="org-string">'^([A-Za-z]+\([0-9]+\))(?=\s+.*?\1$)'</span> || true<span class="org-rainbow-delimiters-depth-1">)</span>

        <span class="org-comment-delimiter"># </span><span class="org-comment">The first line of info manuals is assumed to be</span>
        <span class="org-comment-delimiter">#   </span><span class="org-comment">/path/to/some.info or /path/to/some.info.gz</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">It is not mandatory for the below grep to always pass, so OR it with</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">"true" so that "set -e" does not kill the script at this point.</span>
        <span class="org-variable-name">info_man</span>=$<span class="org-rainbow-delimiters-depth-1">(</span><span class="org-builtin">echo</span> <span class="org-string">"${first_line_piped_data}"</span> | grep -Po <span class="org-string">'^(.*/)*\K[^/]+(?=\.info(\-[0-9]+)*(\.gz)*$)'</span> || true<span class="org-rainbow-delimiters-depth-1">)</span>
</code></pre>
</div>
</div>
<div id="outline-container-org1629f50" class="outline-5">
<h5 id="org1629f50"><span class="section-number-5">5.9.2.1</span> Input is piped from <code>man</code> command</h5>
<div class="outline-text-5" id="text-5-9-2-1">
<div class="org-src-container">
<pre><code class="src src-shell">        <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> ! -z $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">man_page</span><span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
        <span class="org-keyword">then</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">After setting PAGER variable to eless, try something like `man grep'.</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">That will launch the man page in eless.</span>
            <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">debug</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
            <span class="org-keyword">then</span>
                <span class="org-builtin">echo</span> <span class="org-string">"Man Page = ${man_page}"</span>
            fi
            <span class="org-variable-name">cmd</span>=<span class="org-string">"emacs_Q_view_mode \</span>
<span class="org-string">                         ${emacs_args[*]} \</span>
<span class="org-string">                         --eval '(progn</span>
<span class="org-string">                                   (man (downcase \"${man_page}\"))</span>
<span class="org-string">                                   ;; Below workaround is only for emacs 24.5.x and older releases</span>
<span class="org-string">                                   ;; where the man page takes some time to load.</span>
<span class="org-string">                                   ;; 1-second delay before killing the *scratch* window</span>
<span class="org-string">                                   ;; seems to be sufficient</span>
<span class="org-string">                                   (when (version&lt;= emacs-version \"24.5.99\")</span>
<span class="org-string">                                      (sit-for 1))</span>
<span class="org-string">                                   (delete-window))'"</span>
</code></pre>
</div>
<p>
The <code>sit-for</code> hack is needed for emacs versions older than 25.x. It
was reported in <a href="https://github.com/kaushalmodi/eless/issues/3">this issue</a>.
</p>
</div>
</div>
<div id="outline-container-orgd23e2ee" class="outline-5">
<h5 id="orgd23e2ee"><span class="section-number-5">5.9.2.2</span> Input is piped from <code>info</code> command</h5>
<div class="outline-text-5" id="text-5-9-2-2">
<div class="org-src-container">
<pre><code class="src src-shell">        elif <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> ! -z $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">info_man</span><span class="org-rainbow-delimiters-depth-3">}</span> <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
        <span class="org-keyword">then</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">Try something like `info emacs | eless'.</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">That will launch the Info manual in eless.</span>
            <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">debug</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
            <span class="org-keyword">then</span>
                <span class="org-builtin">echo</span> <span class="org-string">"Info Manual = ${info_man}"</span>
            fi
            <span class="org-variable-name">cmd</span>=<span class="org-string">"emacs_Q_view_mode \</span>
<span class="org-string">                         ${emacs_args[*]} \</span>
<span class="org-string">                         --eval '(progn</span>
<span class="org-string">                                   (info (downcase \"${info_man}\")))'"</span>
</code></pre>
</div>
</div>
</div>
<div id="outline-container-orgb085634" class="outline-5">
<h5 id="orgb085634"><span class="section-number-5">5.9.2.3</span> Input is piped from something else</h5>
<div class="outline-text-5" id="text-5-9-2-3">
<p>
This scenario could be anything, like:
</p>
<div class="org-src-container">
<pre><code class="src src-shell">diff a b | eless
grep <span class="org-string">'foo'</span> bar | eless
ls --color=always | eless
</code></pre>
</div>

<p>
In that case, just open the <code>${tempfile}</code> saved from the <code>STDIN</code>
stream using <code>emacs_Q_view_mode</code>.
</p>
<div class="org-src-container">
<pre><code class="src src-shell">        <span class="org-keyword">else</span> <span class="org-comment-delimiter"># </span><span class="org-comment">No man page or info manual detected</span>
            <span class="org-keyword">if</span> <span class="org-rainbow-delimiters-depth-1">[</span><span class="org-rainbow-delimiters-depth-2">[</span> $<span class="org-rainbow-delimiters-depth-3">{</span><span class="org-variable-name">debug</span><span class="org-rainbow-delimiters-depth-3">}</span> -eq 1 <span class="org-rainbow-delimiters-depth-2">]</span><span class="org-rainbow-delimiters-depth-1">]</span>
            <span class="org-keyword">then</span>
                <span class="org-builtin">echo</span> <span class="org-string">"No man page or info manual detected"</span>
            fi
            <span class="org-variable-name">cmd</span>=<span class="org-string">"emacs_Q_view_mode ${tempfile} \</span>
<span class="org-string">                         ${emacs_args[*]} \</span>
<span class="org-string">                         --eval '(progn</span>
<span class="org-string">                                   (set-visited-file-name nil)</span>
<span class="org-string">                                   (rename-buffer \"*Stdin*\" :unique))'"</span>

        fi
</code></pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org40597b1" class="outline-4">
<h4 id="org40597b1"><span class="section-number-4">5.9.3</span> Input is an argument to the script</h4>
<div class="outline-text-4" id="text-5-9-3">
<div class="org-src-container">
<pre><code class="src src-shell">        <span class="org-comment-delimiter"># </span><span class="org-comment">Below else condition is reached when you do this:</span>
        <span class="org-comment-delimiter">#   </span><span class="org-comment">eless foo.txt</span>
    <span class="org-keyword">else</span>
        <span class="org-variable-name">cmd</span>=<span class="org-string">"emacs_Q_view_mode ${emacs_args[*]}"</span>
    fi
</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org7544b28" class="outline-2">
<h2 id="org7544b28"><span class="section-number-2">6</span> Contributing Guide&#xa0;&#xa0;&#xa0;<span class="tag"><span class="contributing">contributing</span></span></h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org1241c89" class="outline-3">
<h3 id="org1241c89"><span class="section-number-3">6.1</span> How to help debug</h3>
<div class="outline-text-3" id="text-6-1">
<ul class="org-ul">
<li>If you find <code>eless</code> not working as expected, file an <a href="https://github.com/kaushalmodi/eless/issues">issue</a>.</li>
<li>Include the following debug information:
<ol class="org-ol">
<li><code>emacs --version</code></li>
<li><code>eless</code> debug info:
<ul class="org-ul">
<li>Append the <code>-D</code> option to your <code>eless</code> use case. Examples:
<ul class="org-ul">
<li><code>eless foo -D</code></li>
<li><code>info org | eless -D</code></li>
</ul></li>
<li>If you are providing debug info for something like <code>man foo</code>, do
<ul class="org-ul">
<li><code>PAGER=​"eless -D" man foo</code></li>
</ul></li>
</ul></li>
</ol></li>
</ul>
</div>
</div>
<div id="outline-container-org6c6b427" class="outline-3">
<h3 id="org6c6b427"><span class="section-number-3">6.2</span> How to generate the <code>eless</code> script</h3>
<div class="outline-text-3" id="text-6-2">
<ul class="org-ul">
<li>Evaluate <code>build/build.el</code>.</li>
<li>Open <code>eless.org</code>.</li>
<li><code>C-c C-e P x</code>, select <code>eless-tangle</code> project.
<ul class="org-ul">
<li>That will generate the <code>eless</code> script and delete trailing
whitespaces from it.</li>
</ul></li>
<li><b>Then you need to save <code>eless</code></b>.</li>
<li>Do <code>C-x v =​</code> in the <code>eless</code> buffer and understand what changes you made.</li>
<li>Provide a PR.</li>
</ul>
</div>
</div>
<div id="outline-container-orgb15e67a" class="outline-3">
<h3 id="orgb15e67a"><span class="section-number-3">6.3</span> How to generate the documentation too</h3>
<div class="outline-text-3" id="text-6-3">
<ul class="org-ul">
<li>Evaluate <code>build/build.el</code>.</li>
<li>Open <code>eless.org</code>.</li>
<li><code>C-c C-e P x</code>, select <code>eless-all</code> project.
<ul class="org-ul">
<li>That will generate the <code>eless</code> script and delete trailing
whitespaces from it.
<ul class="org-ul">
<li><b>Then you need to save <code>eless</code></b>.</li>
</ul></li>
<li>Update HTML and Info documentation.</li>
<li>Update the README, Wiki, etc. pages.</li>
</ul></li>
<li>Understand the changes made in all the files.</li>
<li>Provide a PR.</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
Exported using <div style="display: inline" class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 26.0.50 (<a href="http://orgmode.org">Org</a> mode 9.0.6)</div> by Kaushal.Modi.
</div>
</body>
</html>
